use crate::error::{ParseError, Result};
use std::fmt::Debug;

#[derive(Debug, Clone, Copy, PartialEq)]
pub enum ContainerTag {
    AcquiringData,
    BusinessAddress,
    ClassContract,
    CompanyData,
    ConfirmingCopy,
    Depositor,
    Document,
    ExistingSeriesAndClassesContracts,
    FiledBy,
    Filer,
    FilingValues,
    FormerCompany,
    FormerName,
    Issuer,
    MailAddress,
    Merger,
    MergerSeriesAndClassesContracts,
    OwnerData,
    Paper,
    ReportingOwner,
    Securitizer,
    Series,
    SeriesAndClassesContractsData,
    SubjectCompany,
    Submission,
    TargetData,
}

impl ContainerTag {
    pub fn parse(tag: &str) -> Result<ContainerTag> {
        Ok(match tag {
            "ACQUIRING-DATA" => ContainerTag::AcquiringData,
            "BUSINESS-ADDRESS" => ContainerTag::BusinessAddress,
            "CLASS-CONTRACT" => ContainerTag::ClassContract,
            "COMPANY-DATA" => ContainerTag::CompanyData,
            "CONFIRMING-COPY" => ContainerTag::ConfirmingCopy,
            "DEPOSITOR" => ContainerTag::Depositor,
            "DOCUMENT" => ContainerTag::Document,
            "EXISTING-SERIES-AND-CLASSES-CONTRACTS" => {
                ContainerTag::ExistingSeriesAndClassesContracts
            }
            "FILED-BY" => ContainerTag::FiledBy,
            "FILER" => ContainerTag::Filer,
            "FILING-VALUES" => ContainerTag::FilingValues,
            "FORMER-COMPANY" => ContainerTag::FormerCompany,
            "FORMER-NAME" => ContainerTag::FormerName,
            "ISSUER" => ContainerTag::Issuer,
            "MAIL-ADDRESS" => ContainerTag::MailAddress,
            "MERGER" => ContainerTag::Merger,
            "MERGER-SERIES-AND-CLASSES-CONTRACTS" => ContainerTag::MergerSeriesAndClassesContracts,
            "OWNER-DATA" => ContainerTag::OwnerData,
            "PAPER" => ContainerTag::Paper,
            "REPORTING-OWNER" => ContainerTag::ReportingOwner,
            "SECURITIZER" => ContainerTag::Securitizer,
            "SERIES" => ContainerTag::Series,
            "SERIES-AND-CLASSES-CONTRACTS-DATA" => ContainerTag::SeriesAndClassesContractsData,
            "SUBJECT-COMPANY" => ContainerTag::SubjectCompany,
            "SUBMISSION" => ContainerTag::Submission,
            "TARGET-DATA" => ContainerTag::TargetData,

            _ => return Err(ParseError::InvalidContainerTag(tag.to_string())),
        })
    }
}

#[derive(Debug, Clone, Copy, PartialEq)]
pub enum ValueTag {
    AbsAssetClass,
    AbsRule,
    AccessionNumber,
    Act,
    ActionDate,
    AssignedSic,
    Category,
    Cik,
    City,
    ClassContractId,
    ClassContractName,
    ClassContractTickerSymbol,
    ConformedName,
    DateChanged,
    DateOfFilingDateChange,
    DepositorCik,
    Description,
    EffectivenessDate,
    FileNumber,
    FiledPursuantToGeneralInstructionA2,
    Filename,
    FilingDate,
    FilmNumber,
    FiscalYearEnd,
    FormType,
    FormerConformedName,
    GroupMembers,
    IrsNumber,
    IsFilerANewRegistrant,
    IsFilerAWellKnownSeasondIssuer,
    IsFund24F2Eligible,
    Items,
    MaIIndividual,
    NoAnnualActivity,
    NoQuarterlyActivity,
    OwnerCik,
    Period,
    PeriodStart,
    Phone,
    PublicDocumentCount,
    ReceivedDate,
    Reference462B,
    References429,
    RegisteredEntity,
    Sequence,
    Series,
    SeriesId,
    SeriesName,
    SponsorCik,
    State,
    StateOfInforporation,
    Street1,
    Street2,
    Type,
    Zip,
}

impl ValueTag {
    pub fn parse(tag: &str) -> Result<ValueTag> {
        Ok(match tag {
            "ABS-ASSET-CLASS" => ValueTag::AbsAssetClass,
            "ABS-RULE" => ValueTag::AbsRule,
            "ACCESSION-NUMBER" => ValueTag::AccessionNumber,
            "ACT" => ValueTag::Act,
            "ACTION-DATE" => ValueTag::ActionDate,
            "ASSIGNED-SIC" => ValueTag::AssignedSic,
            "CATEGORY" => ValueTag::Category,
            "CIK" => ValueTag::Cik,
            "CITY" => ValueTag::City,
            "CLASS-CONTRACT-ID" => ValueTag::ClassContractId,
            "CLASS-CONTRACT-NAME" => ValueTag::ClassContractName,
            "CLASS-CONTRACT-TICKER-SYMBOL" => ValueTag::ClassContractTickerSymbol,
            "CONFORMED-NAME" => ValueTag::ConformedName,
            "DATE-CHANGED" => ValueTag::DateChanged,
            "DATE-OF-FILING-DATE-CHANGE" => ValueTag::DateOfFilingDateChange,
            "DEPOSITOR-CIK" => ValueTag::DepositorCik,
            "DESCRIPTION" => ValueTag::Description,
            "EFFECTIVENESS-DATE" => ValueTag::EffectivenessDate,
            "FILE-NUMBER" => ValueTag::FileNumber,
            "FILED-PURSUANT-TO-GENERAL-INSTRUCTION-A2" => {
                ValueTag::FiledPursuantToGeneralInstructionA2
            }
            "FILENAME" => ValueTag::Filename,
            "FILING-DATE" => ValueTag::FilingDate,
            "FILM-NUMBER" => ValueTag::FilmNumber,
            "FISCAL-YEAR-END" => ValueTag::FiscalYearEnd,
            "FORM-TYPE" => ValueTag::FormType,
            "FORMER-CONFORMED-NAME" => ValueTag::FormerConformedName,
            "GROUP-MEMBERS" => ValueTag::GroupMembers,
            "IRS-NUMBER" => ValueTag::IrsNumber,
            "IS-FILER-A-NEW-REGISTRANT" => ValueTag::IsFilerANewRegistrant,
            "IS-FILER-A-WELL-KNOWN-SEASONED-ISSUER" => ValueTag::IsFilerAWellKnownSeasondIssuer,
            "IS-FUND-24F2-ELIGIBLE" => ValueTag::IsFund24F2Eligible,
            "ITEMS" => ValueTag::Items,
            "MA-I_INDIVIDUAL" => ValueTag::MaIIndividual,
            "NO-ANNUAL-ACTIVITY" => ValueTag::NoAnnualActivity,
            "NO-QUARTERLY-ACTIVITY" => ValueTag::NoQuarterlyActivity,
            "OWNER-CIK" => ValueTag::OwnerCik,
            "PERIOD" => ValueTag::Period,
            "PERIOD-START" => ValueTag::PeriodStart,
            "PHONE" => ValueTag::Phone,
            "PUBLIC-DOCUMENT-COUNT" => ValueTag::PublicDocumentCount,
            "RECEIVED-DATE" => ValueTag::ReceivedDate,
            "REFERENCE-462B" => ValueTag::Reference462B,
            "REFERENCES-429" => ValueTag::References429,
            "REGISTERED-ENTITY" => ValueTag::RegisteredEntity,
            "SEQUENCE" => ValueTag::Sequence,
            "SERIES" => ValueTag::Series,
            "SERIES-ID" => ValueTag::SeriesId,
            "SERIES-NAME" => ValueTag::SeriesName,
            "SPONSOR-CIK" => ValueTag::SponsorCik,
            "STATE" => ValueTag::State,
            "STATE-OF-INCORPORATION" => ValueTag::StateOfInforporation,
            "STREET1" => ValueTag::Street1,
            "STREET2" => ValueTag::Street2,
            "TYPE" => ValueTag::Type,
            "ZIP" => ValueTag::Zip,
            _ => return Err(ParseError::InvalidValueTag(tag.to_string())),
        })
    }
}
